#include "program.h"

/*
=================================================================================================================================================================

=================================================================================================================================================================
*/
Program::Program()
{
    mWindow.create(sf::VideoMode(1280, 700), "FTW Ship Editor");
    mWindow.setFramerateLimit(60);
    mWindow.setPosition(sf::Vector2i(-1300, -5));
    changeState(std::make_shared<StartState>(this)); //To be uncommented on project completion
}


/*
=================================================================================================================================================================

=================================================================================================================================================================
*/
void Program::runProgram()
{
    mWindow.display();
    while (mWindow.isOpen())
    {
        mWindow.clear();
        windowEvents();

        auto guard = mState;
        mState->input   ();
        mState->update  ();
        mState->draw    ();

        mWindow.display();
    }
}

/*
=================================================================================================================================================================

=================================================================================================================================================================
*/
sf::RenderWindow& Program::window()
{
    return mWindow;
}

/*
=================================================================================================================================================================

=================================================================================================================================================================
*/
void Program::windowEvents()
{
    sf::Event e;
    while (mWindow.pollEvent(e))
    {
        if (e.type == sf::Event::Closed)
        {
            mWindow.close();
        }
    }
}

/*
=================================================================================================================================================================

=================================================================================================================================================================
*/
void Program::changeState(std::shared_ptr<State> state)
{
    auto guard = mState;
    mState = state;
}
